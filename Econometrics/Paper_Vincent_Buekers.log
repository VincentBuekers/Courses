----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/Vincent/Desktop/AA Econometrics/Paper/Paper_Vincent_Buekers.lo
> g
  log type:  text
 opened on:  28 Jul 2019, 17:53:37

. 
. * -----------------------------------------------------
. * Do-file: Paper for Advanced Applied Econometrics 2019
. * Vincent Buekers
. *------------------------------------------------------
. 
. * Data
. import delimited data-cmbs.txt
(15 vars, 3977 obs)
. 
. * Panel data specification
. tsset cid year
       panel variable:  cid (strongly balanced)
        time variable:  year, 1960 to 2000
                delta:  1 unit

. 
. * remove k due to lots of missing values.
. * --> kbc30 will be used as physical capital variable
. drop k

. 
. * info on panel data
. xtdes

     cid:  1, 2, ..., 97                                     n =         97
    year:  1960, 1961, ..., 2000                             T =         41
           Delta(year) = 1 unit
           Span(year)  = 41 periods
           (cid*year uniquely identifies each observation)

Distribution of T_i:   min      5%     25%       50%       75%     95%     max
                        41      41      41        41        41      41      41

     Freq.  Percent    Cum. |  Pattern
 ---------------------------+-------------------------------------------
       97    100.00  100.00 |  11111111111111111111111111111111111111111
 ---------------------------+-------------------------------------------
       97    100.00         |  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

. 
. *-----------------------
. * Descriptive statistics
. *-----------------------
. 
.         xtsum y kbc30 lwdi secondary egc mlines troads cells proads rails

Variable         |      Mean   Std. Dev.       Min        Max |    Observations
-----------------+--------------------------------------------+----------------
y        overall |  2.05e+11   6.67e+11   2.25e+08   9.76e+12 |     N =    3977
         between |             6.08e+11   6.49e+08   5.36e+12 |     n =      97
         within  |             2.81e+11  -2.75e+12   4.61e+12 |     T =      41
                 |                                            |
kbc30    overall |  4.23e+11   1.44e+12   2.97e+07   2.14e+13 |     N =    3977
         between |             1.28e+12   3.99e+08   1.08e+13 |     n =      97
         within  |             6.80e+11  -5.90e+12   1.11e+13 |     T =      41
                 |                                            |
lwdi     overall |  1.76e+07   6.55e+07      64680   7.57e+08 |     N =    3977
         between |             6.39e+07     106260   5.46e+08 |     n =      97
         within  |             1.61e+07  -1.82e+08   2.29e+08 |     T =      41
                 |                                            |
second~y overall |  .8062078   .8243479      .0011    4.44384 |     N =    3977
         between |             .6888589   .0275324   3.281586 |     n =      97
         within  |             .4580358  -.6858308   3.168059 |     T =      41
                 |                                            |
egc      overall |  15417.21   64217.59          1   785926.8 |     N =    3977
         between |             59496.61   4.758316   558394.3 |     n =      97
         within  |             24893.07  -356443.1   242949.7 |     T =      41
                 |                                            |
mlines   overall |   3213347   1.31e+07   110.5651   1.87e+08 |     N =    3977
         between |             1.16e+07   3973.171   1.05e+08 |     n =      97
         within  |              6217600  -5.25e+07   1.33e+08 |     T =      41
                 |                                            |
troads   overall |  189732.5   672908.4       1058    6365590 |     N =    3977
         between |             669543.1   1279.268    6146470 |     n =      97
         within  |              95014.3   -1296030    2007086 |     T =      41
                 |                                            |
cells    overall |  482402.1    4073564          0   1.09e+08 |     N =    3977
         between |              1447276   36.58537   1.15e+07 |     n =      97
         within  |              3810563  -1.10e+07   9.85e+07 |     T =      41
                 |                                            |
proads   overall |  84857.92   341356.2          0    3840655 |     N =    3977
         between |             334343.9   332.2163    3103661 |     n =      97
         within  |             76568.92   -1038556   929865.2 |     T =      41
                 |                                            |
rails    overall |  9486.405   30428.42          0     350116 |     N =    3977
         between |             29736.36          0     264197 |     n =      97
         within  |             7108.671  -94888.62   95405.38 |     T =      41

. 
. *-------------------------
. * Static Regression models
. *-------------------------
. 
. ******
. ** OLS
. ******
.     reg y L.y kbc30 lwdi secondary egc mlines troads cells proads rails

      Source |       SS       df       MS              Number of obs =    3880
-------------+------------------------------           F( 10,  3869) =       .
       Model |  1.7603e+27    10  1.7603e+26           Prob > F      =  0.0000
    Residual |  1.0465e+24  3869  2.7049e+20           R-squared     =  0.9994
-------------+------------------------------           Adj R-squared =  0.9994
       Total |  1.7613e+27  3879  4.5407e+23           Root MSE      =  1.6e+10

------------------------------------------------------------------------------
           y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
           y |
         L1. |   1.057691   .0041158   256.99   0.000     1.049622    1.065761
             |
       kbc30 |  -.0132612   .0011664   -11.37   0.000    -.0155481   -.0109744
        lwdi |   125.7214   6.528532    19.26   0.000     112.9217    138.5211
   secondary |  -3.94e+08   3.70e+08    -1.06   0.287    -1.12e+09    3.32e+08
         egc |  -36577.25   23326.18    -1.57   0.117    -82310.04    9155.539
      mlines |   1113.532   135.6115     8.21   0.000      847.655    1379.409
      troads |  -812.5956   2011.322    -0.40   0.686    -4755.949    3130.757
       cells |   202.0038   101.8507     1.98   0.047     2.317659      401.69
      proads |  -33602.49   3711.972    -9.05   0.000     -40880.1   -26324.88
       rails |   82502.82   25528.87     3.23   0.001     32451.49    132554.1
       _cons |  -6.29e+08   3.96e+08    -1.59   0.112    -1.41e+09    1.48e+08
------------------------------------------------------------------------------

. 
. * Test on homoskedasticity 
. 
.     estat hettest

Breusch-Pagan / Cook-Weisberg test for heteroskedasticity 
         Ho: Constant variance
         Variables: fitted values of y

         chi2(1)      = 39634.47
         Prob > chi2  =   0.0000

.         
. * robust OLS
.         reg y L.y kbc30 lwdi secondary egc mlines troads cells proads rails, rob
> ust

Linear regression                                      Number of obs =    3880
                                                       F( 10,  3869) =43358.38
                                                       Prob > F      =  0.0000
                                                       R-squared     =  0.9994
                                                       Root MSE      =  1.6e+10

------------------------------------------------------------------------------
             |               Robust
           y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
           y |
         L1. |   1.057691   .0134618    78.57   0.000     1.031298    1.084084
             |
       kbc30 |  -.0132612   .0038298    -3.46   0.001    -.0207699   -.0057525
        lwdi |   125.7214   20.13759     6.24   0.000     86.24006    165.2027
   secondary |  -3.94e+08   3.94e+08    -1.00   0.318    -1.17e+09    3.79e+08
         egc |  -36577.25   106440.6    -0.34   0.731    -245262.2    172107.7
      mlines |   1113.532   410.1708     2.71   0.007     309.3602    1917.703
      troads |  -812.5956   4840.592    -0.17   0.867    -10302.95     8677.76
       cells |   202.0038   328.4665     0.61   0.539    -441.9801    845.9877
      proads |  -33602.49   9949.036    -3.38   0.001    -53108.34   -14096.63
       rails |   82502.82   76167.86     1.08   0.279    -66830.17    231835.8
       _cons |  -6.29e+08   4.16e+08    -1.51   0.130    -1.44e+09    1.86e+08
------------------------------------------------------------------------------

. 
. *****************
. * FIXED EFFECTS *
. *****************
. 
. ** within estimation
.         xtreg y kbc30 lwdi secondary egc mlines troads cells proads rails, fe

Fixed-effects (within) regression               Number of obs      =      3977
Group variable: cid                             Number of groups   =        97

R-sq:  within  = 0.9829                         Obs per group: min =        41
       between = 0.6945                                        avg =      41.0
       overall = 0.7419                                        max =        41

                                                F(9,3871)          =  24756.14
corr(u_i, Xb)  = 0.1812                         Prob > F           =    0.0000

------------------------------------------------------------------------------
           y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       kbc30 |   .1732702   .0034231    50.62   0.000     .1665589    .1799815
        lwdi |   4362.078    64.5489    67.58   0.000     4235.525    4488.631
   secondary |  -6.32e+09   1.40e+09    -4.50   0.000    -9.07e+09   -3.57e+09
         egc |  -287968.4   85836.63    -3.35   0.001    -456257.7     -119679
      mlines |   13194.42   322.5764    40.90   0.000     12561.98    13826.85
      troads |   128473.2   11728.23    10.95   0.000     105479.1    151467.3
       cells |   862.6945   261.3023     3.30   0.001     350.3913    1374.998
      proads |   57200.95   23387.56     2.45   0.014     11347.83    103054.1
       rails |   -7772356   159736.9   -48.66   0.000     -8085532    -7459179
       _cons |   6.63e+10   2.21e+09    29.99   0.000     6.20e+10    7.07e+10
-------------+----------------------------------------------------------------
     sigma_u |  3.443e+11
     sigma_e |  3.716e+10
         rho |  .98848787   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0:     F(96, 3871) =   104.36            Prob > F = 0.0000

.         est store fixed

. 
. ** additional goodness of fit criteria 
.         estat ic

Akaike's information criterion and Bayesian information criterion

-----------------------------------------------------------------------------
       Model |    Obs    ll(null)   ll(model)     df          AIC         BIC
-------------+---------------------------------------------------------------
       fixed |   3977   -110476.9   -102383.7     10     204787.3    204850.2
-----------------------------------------------------------------------------
               Note:  N=Obs used in calculating BIC; see [R] BIC note

. 
. ** fitted values:
. 
.     ** linear prediction (x*beta_hat)
.         predict hfe_xb, xb

. 
.     ** linear prediction including FE component (x*beta_hat + alphai_hat)
.         predict hfe_xb_alphai, xbu

. 
.     ** prediction of FE (alphai_hat)
.         predict hfe_alphai, u

. 
.     ** prediction of idiosyncratic error term (e_hat)
.         predict hfe_e, e

. 
.     ** prediction of FE and idiosyncratic error term (alphai_hat + e_hat)
.         predict hfe_alphai_e, ue

. 
.         
.     list cid year y hfe_xb hfe_xb_alphai hfe_alphai hfe_e in 1/20

     +---------------------------------------------------------------------+
     | cid   year          y     hfe_xb   hfe_xb~i   hfe_alp~i       hfe_e |
     |---------------------------------------------------------------------|
  1. |   1   1960   4.19e+10   7.09e+10   6.51e+10   -5.82e+09   -2.32e+10 |
  2. |   1   1961   3.92e+10   7.25e+10   6.67e+10   -5.82e+09   -2.75e+10 |
  3. |   1   1962   2.88e+10   7.28e+10   6.70e+10   -5.82e+09   -3.82e+10 |
  4. |   1   1963   3.69e+10   7.30e+10   6.71e+10   -5.82e+09   -3.02e+10 |
  5. |   1   1964   4.38e+10   7.34e+10   6.76e+10   -5.82e+09   -2.38e+10 |
     |---------------------------------------------------------------------|
  6. |   1   1965   4.89e+10   7.40e+10   6.82e+10   -5.82e+09   -1.93e+10 |
  7. |   1   1966   4.51e+10   7.44e+10   6.86e+10   -5.82e+09   -2.35e+10 |
  8. |   1   1967   4.87e+10   7.38e+10   6.80e+10   -5.82e+09   -1.93e+10 |
  9. |   1   1968   5.27e+10   7.47e+10   6.89e+10   -5.82e+09   -1.62e+10 |
 10. |   1   1969   5.56e+10   7.55e+10   6.96e+10   -5.82e+09   -1.40e+10 |
     |---------------------------------------------------------------------|
 11. |   1   1970   6.00e+10   7.68e+10   7.09e+10   -5.82e+09   -1.10e+10 |
 12. |   1   1971   5.51e+10   7.79e+10   7.21e+10   -5.82e+09   -1.69e+10 |
 13. |   1   1972   6.84e+10   7.94e+10   7.35e+10   -5.82e+09   -5.09e+09 |
 14. |   1   1973   6.77e+10   8.06e+10   7.48e+10   -5.82e+09   -7.16e+09 |
 15. |   1   1974   6.40e+10   8.29e+10   7.71e+10   -5.82e+09   -1.31e+10 |
     |---------------------------------------------------------------------|
 16. |   1   1975   6.52e+10   8.52e+10   7.94e+10   -5.82e+09   -1.41e+10 |
 17. |   1   1976   7.29e+10   8.73e+10   8.15e+10   -5.82e+09   -8.60e+09 |
 18. |   1   1977   7.44e+10   9.06e+10   8.48e+10   -5.82e+09   -1.04e+10 |
 19. |   1   1978   8.00e+10   9.40e+10   8.82e+10   -5.82e+09   -8.19e+09 |
 20. |   1   1979   9.74e+10   9.79e+10   9.20e+10   -5.82e+09    5.35e+09 |
     +---------------------------------------------------------------------+

. 
. 
. ** within estimation with heteroskedasticity-robust standard errors:
. 
.     xtreg y kbc30 lwdi secondary egc mlines troads cells proads rails, fe robust

Fixed-effects (within) regression               Number of obs      =      3977
Group variable: cid                             Number of groups   =        97

R-sq:  within  = 0.9829                         Obs per group: min =        41
       between = 0.6945                                        avg =      41.0
       overall = 0.7419                                        max =        41

                                                F(9,96)            =  15334.47
corr(u_i, Xb)  = 0.1812                         Prob > F           =    0.0000

                                   (Std. Err. adjusted for 97 clusters in cid)
------------------------------------------------------------------------------
             |               Robust
           y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       kbc30 |   .1732702   .0228651     7.58   0.000     .1278832    .2186571
        lwdi |   4362.078   462.0561     9.44   0.000     3444.903    5279.252
   secondary |  -6.32e+09   4.85e+09    -1.30   0.196    -1.59e+10    3.30e+09
         egc |  -287968.4   383100.8    -0.75   0.454     -1048417    472480.7
      mlines |   13194.42   2961.248     4.46   0.000     7316.383    19072.45
      troads |   128473.2   37095.43     3.46   0.001     54839.41    202107.1
       cells |   862.6945   3448.368     0.25   0.803    -5982.262    7707.651
      proads |   57200.95   120300.4     0.48   0.636    -181593.4    295995.3
       rails |   -7772356    1553047    -5.00   0.000    -1.09e+07    -4689581
       _cons |   6.63e+10   1.62e+10     4.10   0.000     3.42e+10    9.84e+10
-------------+----------------------------------------------------------------
     sigma_u |  3.443e+11
     sigma_e |  3.716e+10
         rho |  .98848787   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. 
. 
. ** First differences
.         reg D.y D.kbc30 D.lwdi D.secondary D.egc D.mlines D.troads D.cells D.pro
> ads D.rails, nocons

      Source |       SS       df       MS              Number of obs =    3880
-------------+------------------------------           F(  9,  3871) = 1956.75
       Model |  3.3775e+24     9  3.7528e+23           Prob > F      =  0.0000
    Residual |  7.4240e+23  3871  1.9179e+20           R-squared     =  0.8198
-------------+------------------------------           Adj R-squared =  0.8194
       Total |  4.1199e+24  3880  1.0618e+21           Root MSE      =  1.4e+10

------------------------------------------------------------------------------
         D.y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       kbc30 |
         D1. |   .3417079   .0059348    57.58   0.000     .3300723    .3533434
             |
        lwdi |
         D1. |   2169.757   182.9876    11.86   0.000     1810.996    2528.519
             |
   secondary |
         D1. |  -1.04e+10   5.47e+09    -1.89   0.058    -2.11e+10    3.66e+08
             |
         egc |
         D1. |  -350129.3   133044.9    -2.63   0.009    -610974.1   -89284.49
             |
      mlines |
         D1. |   5493.315   371.2024    14.80   0.000     4765.544    6221.086
             |
      troads |
         D1. |   18248.65   11950.27     1.53   0.127    -5180.768    41678.07
             |
       cells |
         D1. |  -1384.904   249.8798    -5.54   0.000    -1874.812   -894.9949
             |
      proads |
         D1. |   294681.4   26297.73    11.21   0.000     243122.7    346240.2
             |
       rails |
         D1. |   219916.7   228903.1     0.96   0.337    -228865.4    668698.8
------------------------------------------------------------------------------

. 
. ** test for strict exogeneity
.         * within
.         xtreg y kbc30 F.kbc30 lwdi F.lwdi secondary F.secondary egc F.egc mlines
>  F.mlines troads F.troads cells F.cells proads F.proads rails F.rails, fe

Fixed-effects (within) regression               Number of obs      =      3880
Group variable: cid                             Number of groups   =        97

R-sq:  within  = 0.9900                         Obs per group: min =        40
       between = 0.9108                                        avg =      40.0
       overall = 0.9181                                        max =        40

                                                F(18,3765)         =  20619.04
corr(u_i, Xb)  = 0.4332                         Prob > F           =    0.0000

------------------------------------------------------------------------------
           y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       kbc30 |
         --. |  -.8842501   .0255582   -34.60   0.000    -.9343593   -.8341409
         F1. |   1.051424   .0249447    42.15   0.000     1.002518    1.100331
             |
        lwdi |
         --. |   2738.587   743.8599     3.68   0.000      1280.18    4196.995
         F1. |   -325.722   729.9206    -0.45   0.655      -1756.8    1105.356
             |
   secondary |
         --. |  -2.94e+10   2.36e+10    -1.25   0.213    -7.58e+10    1.69e+10
         F1. |   2.97e+10   2.29e+10     1.29   0.196    -1.53e+10    7.46e+10
             |
         egc |
         --. |   -2484637   380649.3    -6.53   0.000     -3230935    -1738338
         F1. |    2313355   360623.6     6.41   0.000      1606319     3020392
             |
      mlines |
         --. |  -1413.852   1255.811    -1.13   0.260    -3875.989    1048.285
         F1. |   10404.71     1059.8     9.82   0.000     8326.874    12482.55
             |
      troads |
         --. |  -65402.03   24451.17    -2.67   0.008    -113340.8    -17463.2
         F1. |   296737.7   25510.79    11.63   0.000     246721.4      346754
             |
       cells |
         --. |  -197.3132   1164.837    -0.17   0.865    -2481.086    2086.459
         F1. |  -574.2155   880.2844    -0.65   0.514    -2300.096    1151.665
             |
      proads |
         --. |     569981   58521.56     9.74   0.000     455243.9      684718
         F1. |  -384446.6   57422.97    -6.69   0.000    -497029.7   -271863.4
             |
       rails |
         --. |   -3318645   500182.8    -6.63   0.000     -4299300    -2337989
         F1. |   -3497657   515004.2    -6.79   0.000     -4507371    -2487943
             |
       _cons |   4.63e+10   1.99e+09    23.22   0.000     4.24e+10    5.02e+10
-------------+----------------------------------------------------------------
     sigma_u |  2.049e+11
     sigma_e |  2.698e+10
         rho |  .98294772   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0:     F(96, 3765) =   158.32            Prob > F = 0.0000

. 
.         * FD
.         reg D.y D.kbc30 kbc30 D.lwdi lwdi D.secondary secondary D.egc egc D.mlin
> es mlines D.troads troads D.cells cells D.proads proads D.rails rails, nocons

      Source |       SS       df       MS              Number of obs =    3880
-------------+------------------------------           F( 18,  3862) = 1199.77
       Model |  3.4949e+24    18  1.9416e+23           Prob > F      =  0.0000
    Residual |  6.2499e+23  3862  1.6183e+20           R-squared     =  0.8483
-------------+------------------------------           Adj R-squared =  0.8476
       Total |  4.1199e+24  3880  1.0618e+21           Root MSE      =  1.3e+10

------------------------------------------------------------------------------
         D.y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       kbc30 |
         D1. |   .4491963   .0102399    43.87   0.000     .4291201    .4692724
         --. |  -.0129855   .0008863   -14.65   0.000    -.0147232   -.0112477
             |
        lwdi |
         D1. |  -1546.063   345.0098    -4.48   0.000    -2222.482   -869.6441
         --. |   83.30992   8.659081     9.62   0.000     66.33312    100.2867
             |
   secondary |
         D1. |   2.24e+10   9.02e+09     2.49   0.013     4.75e+09    4.01e+10
         --. |  -4.36e+08   3.70e+08    -1.18   0.238    -1.16e+09    2.89e+08
             |
         egc |
         D1. |   -1172951   147680.5    -7.94   0.000     -1462491   -883412.2
         --. |   156820.2   19732.34     7.95   0.000     118133.4      195507
             |
      mlines |
         D1. |   3521.158   485.2772     7.26   0.000     2569.734    4472.582
         --. |  -427.9686   136.1345    -3.14   0.002    -694.8709   -161.0663
             |
      troads |
         D1. |    7280.56   11159.93     0.65   0.514    -14599.36    29160.48
         --. |    5585.43    1469.19     3.80   0.000     2704.967    8465.894
             |
       cells |
         D1. |   215.3466   524.2716     0.41   0.681     -812.529    1243.222
         --. |   365.2201   154.3828     2.37   0.018     62.54057    667.8997
             |
      proads |
         D1. |     243489   25864.69     9.41   0.000     192779.2    294198.7
         --. |   16181.02     2958.6     5.47   0.000     10380.45    21981.59
             |
       rails |
         D1. |    1034562     234237     4.42   0.000     575321.9     1493802
         --. |  -25447.98   20334.55    -1.25   0.211    -65315.47     14419.5
------------------------------------------------------------------------------

. 
. *****************
. ** Random effects
. *****************
. 
.         xtreg y kbc30 lwdi secondary egc mlines troads cells proads rails, re

Random-effects GLS regression                   Number of obs      =      3977
Group variable: cid                             Number of groups   =        97

R-sq:  within  = 0.9789                         Obs per group: min =        41
       between = 0.9607                                        avg =      41.0
       overall = 0.9638                                        max =        41

                                                Wald chi2(9)       = 173231.41
corr(u_i, X)   = 0 (assumed)                    Prob > chi2        =    0.0000

------------------------------------------------------------------------------
           y |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       kbc30 |   .1697082   .0038913    43.61   0.000     .1620813    .1773351
        lwdi |   2699.023   53.88172    50.09   0.000     2593.417    2804.629
   secondary |  -1.23e+10   1.60e+09    -7.69   0.000    -1.54e+10   -9.15e+09
         egc |   753337.4   92224.29     8.17   0.000     572581.1    934093.7
      mlines |   13632.04   374.5013    36.40   0.000     12898.03    14366.05
      troads |   283997.5   12019.69    23.63   0.000     260439.4    307555.7
       cells |   1401.382    303.115     4.62   0.000     807.2876    1995.477
      proads |   67048.01   25506.96     2.63   0.009     17055.28    117040.7
       rails |   -4272942   131973.4   -32.38   0.000     -4531605    -4014279
       _cons |   2.06e+10   5.74e+09     3.59   0.000     9.37e+09    3.18e+10
-------------+----------------------------------------------------------------
     sigma_u |  4.576e+10
     sigma_e |  3.716e+10
         rho |  .60264988   (fraction of variance due to u_i)
------------------------------------------------------------------------------

.         est store random

. 
. ** fitted values:
. 
.     ** linear prediction (x*beta_hat)
.         predict hre_xb, xb

. 
.     ** linear prediction including FE component (x*beta_hat + alphai_hat)
.         predict hre_xb_alphai, xbu

. 
.     ** prediction of FE (alphai_hat)
.         predict hre_alphai, u

. 
.    ** prediction of idiosyncratic error term (e_hat)
.         predict hre_e, e

. 
.     ** prediction of FE and idiosyncratic error term (alphai_hat + e_hat)
.         predict hre_alphai_e, ue

.         
. list cid year y hre_xb hre_xb_alphai hre_alphai hre_e in 1/20

     +--------------------------------------------------------------------+
     | cid   year          y     hre_xb   hre_xb~i   hre_al~i       hre_e |
     |--------------------------------------------------------------------|
  1. |   1   1960   4.19e+10   4.31e+10   6.56e+10   2.26e+10   -2.37e+10 |
  2. |   1   1961   3.92e+10   4.44e+10   6.70e+10   2.26e+10   -2.78e+10 |
  3. |   1   1962   2.88e+10   4.51e+10   6.77e+10   2.26e+10   -3.89e+10 |
  4. |   1   1963   3.69e+10   4.54e+10   6.80e+10   2.26e+10   -3.11e+10 |
  5. |   1   1964   4.38e+10   4.59e+10   6.85e+10   2.26e+10   -2.47e+10 |
     |--------------------------------------------------------------------|
  6. |   1   1965   4.89e+10   4.67e+10   6.92e+10   2.26e+10   -2.03e+10 |
  7. |   1   1966   4.51e+10   4.73e+10   6.99e+10   2.26e+10   -2.48e+10 |
  8. |   1   1967   4.87e+10   4.73e+10   6.99e+10   2.26e+10   -2.12e+10 |
  9. |   1   1968   5.27e+10   4.83e+10   7.09e+10   2.26e+10   -1.82e+10 |
 10. |   1   1969   5.56e+10   4.94e+10   7.20e+10   2.26e+10   -1.64e+10 |
     |--------------------------------------------------------------------|
 11. |   1   1970   6.00e+10   5.05e+10   7.31e+10   2.26e+10   -1.31e+10 |
 12. |   1   1971   5.51e+10   5.13e+10   7.39e+10   2.26e+10   -1.88e+10 |
 13. |   1   1972   6.84e+10   5.30e+10   7.56e+10   2.26e+10   -7.19e+09 |
 14. |   1   1973   6.77e+10   5.43e+10   7.69e+10   2.26e+10   -9.21e+09 |
 15. |   1   1974   6.40e+10   5.61e+10   7.87e+10   2.26e+10   -1.47e+10 |
     |--------------------------------------------------------------------|
 16. |   1   1975   6.52e+10   5.81e+10   8.07e+10   2.26e+10   -1.55e+10 |
 17. |   1   1976   7.29e+10   5.99e+10   8.25e+10   2.26e+10   -9.65e+09 |
 18. |   1   1977   7.44e+10   6.28e+10   8.54e+10   2.26e+10   -1.10e+10 |
 19. |   1   1978   8.00e+10   6.66e+10   8.92e+10   2.26e+10   -9.16e+09 |
 20. |   1   1979   9.74e+10   7.01e+10   9.27e+10   2.26e+10    4.70e+09 |
     +--------------------------------------------------------------------+

. 
.         
. ** Test on random effects
. 
.     xttest0

Breusch and Pagan Lagrangian multiplier test for random effects

        y[cid,t] = Xb + u[cid] + e[cid,t]

        Estimated results:
                         |       Var     sd = sqrt(Var)
                ---------+-----------------------------
                       y |   4.45e+23       6.67e+11
                       e |   1.38e+21       3.72e+10
                       u |   2.09e+21       4.58e+10

        Test:   Var(u) = 0
                             chibar2(01) = 16636.61
                          Prob > chibar2 =   0.0000

. 
. ** RE estimation with heteroskedasticity-robust standard errors:
. 
.     xtreg y kbc30 lwdi secondary egc mlines troads cells proads rails, re robust

Random-effects GLS regression                   Number of obs      =      3977
Group variable: cid                             Number of groups   =        97

R-sq:  within  = 0.9789                         Obs per group: min =        41
       between = 0.9607                                        avg =      41.0
       overall = 0.9638                                        max =        41

                                                Wald chi2(9)       =  71195.94
corr(u_i, X)   = 0 (assumed)                    Prob > chi2        =    0.0000

                                   (Std. Err. adjusted for 97 clusters in cid)
------------------------------------------------------------------------------
             |               Robust
           y |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       kbc30 |   .1697082   .0496369     3.42   0.001     .0724216    .2669949
        lwdi |   2699.023   327.3812     8.24   0.000     2057.368    3340.678
   secondary |  -1.23e+10   5.81e+09    -2.11   0.035    -2.37e+10   -8.92e+08
         egc |   753337.4   531820.5     1.42   0.157    -289011.6     1795686
      mlines |   13632.04   2988.317     4.56   0.000     7775.048    19489.03
      troads |   283997.5   94722.07     3.00   0.003     98345.69    469649.4
       cells |   1401.382   3087.403     0.45   0.650    -4649.816     7452.58
      proads |   67048.01   214003.7     0.31   0.754    -352391.6    486487.6
       rails |   -4272942    1192514    -3.58   0.000     -6610227    -1935657
       _cons |   2.06e+10   1.46e+10     1.42   0.157    -7.92e+09    4.91e+10
-------------+----------------------------------------------------------------
     sigma_u |  4.576e+10
     sigma_e |  3.716e+10
         rho |  .60264988   (fraction of variance due to u_i)
------------------------------------------------------------------------------

.         
.         
. *-----------------
. * Dynamic models
. *-----------------
. 
. ********
. ** IV **
. ********
. 
. * Robust SE's using standard IV using DELTA(y_t-2) as instrument
. ivregress 2sls D.y D.kbc30 D.lwdi D.secondary D.egc D.mlines D.troads D.cells D.
> proads D.rails (L.D.y = L2.D.y)

Instrumental variables (2SLS) regression               Number of obs =    3686
                                                       Wald chi2(10) = 8193.76
                                                       Prob > chi2   =  0.0000
                                                       R-squared     =  0.6345
                                                       Root MSE      =  1.9e+10

------------------------------------------------------------------------------
         D.y |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
           y |
         LD. |   -.879123    .143505    -6.13   0.000    -1.160388   -.5978584
             |
       kbc30 |
         D1. |    .675879    .055195    12.25   0.000     .5676988    .7840592
             |
        lwdi |
         D1. |    3895.08   387.7503    10.05   0.000     3135.103    4655.056
             |
   secondary |
         D1. |  -2.23e+10   1.07e+10    -2.08   0.038    -4.33e+10   -1.29e+09
             |
         egc |
         D1. |  -626241.6   193654.4    -3.23   0.001     -1005797   -246686.1
             |
      mlines |
         D1. |   7879.711   652.5365    12.08   0.000     6600.763    9158.659
             |
      troads |
         D1. |   101010.2   22197.78     4.55   0.000     57503.37    144517.1
             |
       cells |
         D1. |  -3363.725   478.2758    -7.03   0.000    -4301.128   -2426.322
             |
      proads |
         D1. |   316932.2   38768.99     8.17   0.000     240946.4      392918
             |
       rails |
         D1. |    1194138   358495.8     3.33   0.001       491499     1896777
             |
       _cons |   5.93e+07   4.62e+08     0.13   0.898    -8.47e+08    9.65e+08
------------------------------------------------------------------------------
Instrumented:  LD.y
Instruments:   D.kbc30 D.lwdi D.secondary D.egc D.mlines D.troads D.cells
               D.proads D.rails L2D.y

. ivregress 2sls D.y D.kbc30 D.lwdi D.secondary D.egc D.mlines D.troads D.cells D.
> proads D.rails (L.D.y = L2.D.y), robust

Instrumental variables (2SLS) regression               Number of obs =    3686
                                                       Wald chi2(10) =  661.24
                                                       Prob > chi2   =  0.0000
                                                       R-squared     =  0.6345
                                                       Root MSE      =  1.9e+10

------------------------------------------------------------------------------
             |               Robust
         D.y |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
           y |
         LD. |   -.879123   .8037454    -1.09   0.274    -2.454435    .6961889
             |
       kbc30 |
         D1. |    .675879   .3142945     2.15   0.032     .0598731    1.291885
             |
        lwdi |
         D1. |    3895.08   1738.944     2.24   0.025     486.8124    7303.347
             |
   secondary |
         D1. |  -2.23e+10   1.38e+10    -1.61   0.106    -4.93e+10    4.77e+09
             |
         egc |
         D1. |  -626241.6   938664.7    -0.67   0.505     -2465991     1213507
             |
      mlines |
         D1. |   7879.711   3275.181     2.41   0.016     1460.474    14298.95
             |
      troads |
         D1. |   101010.2    72160.6     1.40   0.162    -40421.96    242442.4
             |
       cells |
         D1. |  -3363.725   2359.838    -1.43   0.154    -7988.922    1261.472
             |
      proads |
         D1. |   316932.2   196317.5     1.61   0.106    -67843.07    701707.5
             |
       rails |
         D1. |    1194138    2095691     0.57   0.569     -2913342     5301617
             |
       _cons |   5.93e+07   2.76e+08     0.21   0.830    -4.81e+08    6.00e+08
------------------------------------------------------------------------------
Instrumented:  LD.y
Instruments:   D.kbc30 D.lwdi D.secondary D.egc D.mlines D.troads D.cells
               D.proads D.rails L2D.y

. 
. 
. *******
. * GMM *
. *******
. * Two-step + finite sample correction + predetermined variables + laglimit = 3
. xtabond2 y L.y kbc30 lwdi secondary egc mlines troads cells proads rails year, g
> mm(L.y) gmm(kbc30, laglimits(1 3)) gmm(lwdi, laglimits(1 3)) gmm(secondary, lagl
> imits(1 3)) gmm(egc, laglimits(1 3)) gmm(mlines, laglimits(1 3)) gmm(troads, lag
> limits(1 3)) gmm(cells, laglimits(1 3)) gmm(proads, laglimits(1 3)) gmm(rails, l
> aglimits(1 3)) iv(year) noleveleq twostep robust
Favoring space over speed. To switch, type or click on mata: mata set matafavor sp
> eed, perm.
Warning: Number of instruments may be large relative to number of observations.
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate optimal weighting matrix for two-step e
> stimation.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, two-step difference GMM
------------------------------------------------------------------------------
Group variable: cid                             Number of obs      =      3783
Time variable : year                            Number of groups   =        97
Number of instruments = 1765                    Obs per group: min =        39
Wald chi2(11) =  1.02e+08                                      avg =     39.00
Prob > chi2   =     0.000                                      max =        39
------------------------------------------------------------------------------
             |              Corrected
           y |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
           y |
         L1. |   1.026274   .0567011    18.10   0.000     .9151417    1.137406
             |
       kbc30 |  -.0134364   .0104283    -1.29   0.198    -.0338756    .0070027
        lwdi |   844.9458   184.9942     4.57   0.000     482.3638    1207.528
   secondary |   2.84e+09   3.82e+09     0.74   0.458    -4.65e+09    1.03e+10
         egc |  -196645.1   94813.17    -2.07   0.038    -382475.5    -10814.7
      mlines |    1413.81   645.5957     2.19   0.029     148.4653    2679.154
      troads |  -40145.74    14660.9    -2.74   0.006    -68880.57   -11410.91
       cells |   523.1697   597.6609     0.88   0.381    -648.2243    1694.564
      proads |  -7388.233   32610.64    -0.23   0.821    -71303.91    56527.44
       rails |  -577608.9   380346.4    -1.52   0.129     -1323074    167856.4
        year |  -2.07e+08   8.82e+07    -2.35   0.019    -3.80e+08   -3.45e+07
------------------------------------------------------------------------------
Instruments for first differences equation
  Standard
    D.year
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/3).rails
    L(1/3).proads
    L(1/3).cells
    L(1/3).troads
    L(1/3).mlines
    L(1/3).egc
    L(1/3).secondary
    L(1/3).lwdi
    L(1/3).kbc30
    L(1/40).L.y
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -1.90  Pr > z =  0.058
Arellano-Bond test for AR(2) in first differences: z =  -1.28  Pr > z =  0.202
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(1754) =4877.93  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(1754) =  95.21  Prob > chi2 =  1.000
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  gmm(L.y, lag(1 .))
    Hansen test excluding group:     chi2(974)  =  97.22  Prob > chi2 =  1.000
    Difference (null H = exogenous): chi2(780)  =  -2.02  Prob > chi2 =  1.000
  gmm(kbc30, lag(1 3))
    Hansen test excluding group:     chi2(1638) =  90.39  Prob > chi2 =  1.000
    Difference (null H = exogenous): chi2(116)  =   4.81  Prob > chi2 =  1.000
  gmm(lwdi, lag(1 3))
    Hansen test excluding group:     chi2(1639) =  99.17  Prob > chi2 =  1.000
    Difference (null H = exogenous): chi2(115)  =  -3.97  Prob > chi2 =  1.000
  gmm(secondary, lag(1 3))
    Hansen test excluding group:     chi2(1638) =  95.04  Prob > chi2 =  1.000
    Difference (null H = exogenous): chi2(116)  =   0.17  Prob > chi2 =  1.000
  gmm(egc, lag(1 3))
    Hansen test excluding group:     chi2(1638) =  95.24  Prob > chi2 =  1.000
    Difference (null H = exogenous): chi2(116)  =  -0.04  Prob > chi2 =  1.000
  gmm(mlines, lag(1 3))
    Hansen test excluding group:     chi2(1638) =  95.24  Prob > chi2 =  1.000
    Difference (null H = exogenous): chi2(116)  =  -0.04  Prob > chi2 =  1.000
  gmm(troads, lag(1 3))
    Hansen test excluding group:     chi2(1638) =  95.24  Prob > chi2 =  1.000
    Difference (null H = exogenous): chi2(116)  =  -0.04  Prob > chi2 =  1.000
  gmm(cells, lag(1 3))
    Hansen test excluding group:     chi2(1697) =  95.37  Prob > chi2 =  1.000
    Difference (null H = exogenous): chi2(57)   =  -0.16  Prob > chi2 =  1.000
  gmm(proads, lag(1 3))
    Hansen test excluding group:     chi2(1638) =  95.24  Prob > chi2 =  1.000
    Difference (null H = exogenous): chi2(116)  =  -0.04  Prob > chi2 =  1.000
  gmm(rails, lag(1 3))
    Hansen test excluding group:     chi2(1638) =  95.24  Prob > chi2 =  1.000
    Difference (null H = exogenous): chi2(116)  =  -0.04  Prob > chi2 =  1.000
  iv(year)
    Hansen test excluding group:     chi2(1753) =  86.08  Prob > chi2 =  1.000
    Difference (null H = exogenous): chi2(1)    =   9.12  Prob > chi2 =  0.003


. 
. log close
      name:  <unnamed>
       log:  /Users/Vincent/Desktop/AA Econometrics/Paper/Paper_Vincent_Buekers.lo
> g
  log type:  text
 closed on:  28 Jul 2019, 17:54:15
----------------------------------------------------------------------------------
